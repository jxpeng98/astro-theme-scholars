---
import Layout from '../layouts/Layout.astro';
import aboutRaw from '../data/about.yml?raw';
import { parse } from 'yaml';

interface AboutData {
	hero: {
		title: string;
		description: string;
	};
	profile: Array<{ label: string; value: string }>;
	experience: Array<{
		role: string;
		organization: string;
		period: string;
		bullets: string[];
	}>;
	service: string[];
	education?: Array<{ degree: string; institution: string; year: string | number }>;
}

const aboutData = parse(aboutRaw) as AboutData;
const { hero, profile, experience, service, education = [] } = aboutData;
---

<Layout>
	<section class="flex flex-col gap-3 mb-8">
		<h1 class="font-heading text-[clamp(2rem,3vw,2.6rem)] font-semibold text-slate-900 dark:text-slate-100">
			{hero.title}
		</h1>
		<p class="m-0 text-slate-600 dark:text-slate-300 max-w-[65ch]">{hero.description}</p>
	</section>

	{education.length > 0 && (
		<section class="flex flex-col gap-3">
			<h2 class="font-heading text-xl font-semibold text-slate-900 dark:text-slate-100">Education</h2>
			<ul class="list-disc pl-6 space-y-3 text-slate-600 dark:text-slate-300 m-0">
				{education.map((item) => (
					<li>
						<div class="font-semibold text-slate-900 dark:text-slate-100">{item.degree}</div>
						<div class="text-sm text-slate-500 dark:text-slate-400">{item.institution} · {item.year}</div>
					</li>
				))}
			</ul>
		</section>
	)}

	<section class="mt-8 flex flex-col gap-3">
		<h2 class="font-heading text-xl font-semibold text-slate-900 dark:text-slate-100">Profile</h2>
		<ul class="list-disc pl-6 space-y-2 text-slate-600 dark:text-slate-300 m-0">
			{profile.map((item) => (
				<li>
					<strong>{item.label}:</strong> {item.value}
				</li>
			))}
		</ul>
	</section>

	<section class="mt-8 flex flex-col gap-4">
		<h2 class="font-heading text-xl font-semibold text-slate-900 dark:text-slate-100">Experience</h2>
		{experience.map((entry, idx) => (
			<article class="border-b border-slate-200 dark:border-slate-700 pb-4 mb-6" class:list={{ 'border-none pb-0 mb-0': idx === experience.length - 1 }}>
				<h3 class="font-heading text-lg font-semibold text-slate-900 dark:text-slate-100">
					{entry.role} · {entry.organization}
				</h3>
				<p class="text-sm text-slate-500 dark:text-slate-400 mt-1">{entry.period}</p>
				<ul class="list-disc pl-6 space-y-2 text-slate-600 dark:text-slate-300 m-0 mt-2">
					{entry.bullets.map((bullet) => (
						<li>{bullet}</li>
					))}
				</ul>
			</article>
		))}
	</section>

	<section class="mt-8 flex flex-col gap-3">
		<h2 class="font-heading text-xl font-semibold text-slate-900 dark:text-slate-100">Selected Service</h2>
		<ul class="list-disc pl-6 space-y-2 text-slate-600 dark:text-slate-300 m-0">
			{service.map((item) => (
				<li>{item}</li>
			))}
		</ul>
	</section>
</Layout>
