---
import Layout from '../layouts/Layout.astro';
import teachingRaw from '../data/teaching.yml?raw';
import { parse } from 'yaml';

interface TeachingSection {
	term: string;
	modules: Array<{
		title: string;
		code: string;
		summary: string;
		tags?: string[];
		link?: {
			label?: string;
			href: string;
		};
	}>;
}

interface TeachingData {
	current: TeachingSection[];
	past: TeachingSection[];
}

const teachingData = parse(teachingRaw) as TeachingData;
const { current = [], past = [] } = teachingData;
---

<Layout>
	<section class="flex flex-col gap-3 mb-8">
		<h1 class="font-heading text-[clamp(2rem,3vw,2.6rem)] font-semibold text-slate-900 dark:text-slate-100">Teaching</h1>
		<p class="m-0 text-slate-600 dark:text-slate-300 max-w-[65ch]">
			Summary of current and past modules taught by Your Name. Each listing includes a short description and topical tags to help students find relevant courses quickly.
		</p>
	</section>

	{current.length > 0 && (
		<section class="flex flex-col gap-5">
			<h2 class="font-heading text-xl font-semibold text-slate-900 dark:text-slate-100">Current Modules</h2>
			{current.map((section) => (
				<div>
					<h3 class="font-heading text-lg font-semibold text-slate-900 dark:text-slate-100 mb-3">{section.term}</h3>
					<div class="grid gap-4">
						{section.modules.map((module) => (
							<article class="flex flex-col gap-3 border border-slate-200 dark:border-slate-700 rounded-2xl bg-white dark:bg-slate-900 px-5 py-5 shadow-[0_12px_24px_rgba(76,29,149,0.12)] dark:shadow-[0_16px_32px_rgba(10,10,20,0.5)]">
								<header class="flex flex-col gap-1">
									<h4 class="font-heading text-base font-semibold text-slate-900 dark:text-slate-100">
										{module.title}
									</h4>
									<p class="text-sm text-slate-500 dark:text-slate-400 m-0">{module.code}</p>
								</header>
								<p class="m-0 text-slate-600 dark:text-slate-300">{module.summary}</p>
								{module.tags?.length || module.link ? (
									<div class="flex flex-wrap items-center gap-3 mt-1">
										{module.tags?.length ? (
											<ul class="chips-row">
												{module.tags.map((tag) => (
													<li class="chips-item">{tag}</li>
												))}
											</ul>
										) : null}
										{module.link ? (
											<a
												class="btn-primary ml-auto"
												href={module.link.href}
												target="_blank"
												rel="noreferrer"
											>
												{module.link.label ?? 'Course website'}
											</a>
										) : null}
									</div>
								) : null}
							</article>
						))}
					</div>
				</div>
			))}
		</section>
	)}

	{past.length > 0 && (
		<section class="flex flex-col gap-5 mt-10">
			<h2 class="font-heading text-xl font-semibold text-slate-900 dark:text-slate-100">Past Modules</h2>
			{past.map((section) => (
				<div>
					<h3 class="font-heading text-lg font-semibold text-slate-900 dark:text-slate-100 mb-3">{section.term}</h3>
					<div class="grid gap-4">
						{section.modules.map((module) => (
							<article class="flex flex-col gap-3 border border-slate-200 dark:border-slate-700 rounded-2xl bg-slate-50 dark:bg-slate-900 px-5 py-5 shadow-[0_12px_24px_rgba(76,29,149,0.1)] dark:shadow-none">
								<header class="flex flex-col gap-1">
									<h4 class="font-heading text-base font-semibold text-slate-900 dark:text-slate-100">
										{module.title}
									</h4>
									<p class="text-sm text-slate-500 dark:text-slate-400 m-0">{module.code}</p>
								</header>
								<p class="m-0 text-slate-600 dark:text-slate-300">{module.summary}</p>
								{module.tags?.length || module.link ? (
									<div class="flex flex-wrap items-center gap-3 mt-1">
										{module.tags?.length ? (
											<ul class="chips-row">
												{module.tags.map((tag) => (
													<li class="chips-item">{tag}</li>
												))}
											</ul>
										) : null}
										{module.link ? (
											<a
												class="btn-primary ml-auto"
												href={module.link.href}
												target="_blank"
												rel="noreferrer"
											>
												{module.link.label ?? 'Course website'}
											</a>
										) : null}
									</div>
								) : null}
							</article>
						))}
					</div>
				</div>
			))}
		</section>
	)}
</Layout>
